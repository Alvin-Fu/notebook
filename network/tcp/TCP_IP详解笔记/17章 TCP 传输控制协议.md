# TCP简介
[TCP/IP详解目录](http://www.52im.net/topic-tcpipvol1.html)
[第17章](http://docs.52im.net/extend/docs/book/tcpip/vol1/17/)
## 概要
TCP和UDP都是位于传输层的协议，不同的是TCP是面向连接的可靠的，UDP是不可靠的。
在TCP传输数据时先需要建立连接，进行准备，准备工作结束后才可以进行数据传输，如果包没有传到，会进行重传
UDP只要保证报发出去就好了，不需要去确认包是否被收到，UDP的一个套接字可以对应多个端口
## TCP如何提供可靠性
原文记录：
- 应用数据被拆分成TCP认为的最适合发送的数据快，由TCP传递给IP的信息单位称为报文段或段
- TCP发出一个段后会启动一个定时期，等待目的端确认收到这个报文段。如果不能及时收到就会重发这个报文段
- TCP的接收段如果收到了数据包时会给对端发送一个确认包，并且这个确认包不是立即发送，通常会推迟几分之一秒
- TCP将保存首部和数据的校验和。这是端到端的校验和，为了防止包在传输过程中出现问题，校验和有问题时TCP将丢弃这个包(希望发送法超时重发)
- 由于TCP报文段是作为IP数据报来传输的，由于IP数据报在传输的过程是无序的，因此有必要是TCP会重新对数据报进行排序，将正确的顺序交给应用层
- IP数据报会发生重复，TCP会将重复的报丢弃
- 可以做流量控制。TCP的每一方都有一个固定的缓冲空间，TCP接收端只允许缓冲空间可以容纳的数据，防止较快主机导致较慢主机的缓冲区数据溢出。
## 小结
可以看到TCP和UDP的头部都是包含了双方的端口，但是TCP的头部包含的内容更多
看一个TCP连接使用的过程
1. 建立连接
2. 发送方发送数据包，接收方收到后返回确认包，如果没有重新发，有就发送下一个
3. 接收方等待数据包，接收到时对数据包进行校验，符合就返回(ACK)确认包，并继续等待，直到收到FIN
4. 中止连接



























